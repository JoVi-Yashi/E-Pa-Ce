spring.application.name=backend
server.port=8081

#------------------------------------------------------------------
#               Conexion Base de Datos
#------------------------------------------------------------------

# 1. Configuracion de la URL de la Base de Datos
spring.datasource.url=jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:EPaCe}

# 2. Credenciales
spring.datasource.username=${DB_USERNAME:postgres}
spring.datasource.password=${DB_PASSWORD:PS8289}

# 3. Especificar el driver
spring.datasource.driver-class-name=org.postgresql.Driver


#-------------------------------------------------------------------
#               EndPoints Actuator
#-------------------------------------------------------------------

management.endpoints.web.base-path=/actuator
management.endpoints.web.exposure.include=*
management.info.env.enabled=true

info.app.name=EPaCe
info.app.description=Aplicativo web para gestionar reuniones y su respectivo check-in
info.app.version=0.0.1-ALPHA


#-------------------------------------------------------------------
#               Security & JWT Configuration
#-------------------------------------------------------------------

spring.security.user.name=paco
spring.security.user.password=12345

# JWT Configuration
# IMPORTANTE: Cambiar esta clave secreta en producci\u00F3n (usar al menos 256 bits)
app.jwtSecret=404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970337336763979244226452948404D635166546A576E5A7234753778214125442A
# 20 minutos = 1,200,000 ms
app.jwtExpirationMs=1200000

# Server Session Timeout
server.servlet.session.timeout=20m

# Logging for Security Debugging
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG


#--------------------------------------------------------------------
#               Spring Data JPA and Hibernate Configuration
#--------------------------------------------------------------------

# Configure the Hibernate DDL-auto mode
# Options: none, update, create, create-drop, validate
# IMPORTANTE: En producción usar 'validate' y Flyway
spring.jpa.hibernate.ddl-auto=validate

# Flyway Configuration
spring.flyway.enabled=true
spring.flyway.baseline-on-migrate=true
spring.flyway.baseline-version=0
spring.flyway.out-of-order=false
spring.flyway.clean-disabled=false
spring.flyway.clean-on-validation-error=true

# Set the dialect to optimize SQL for PostgreSQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# Show generated SQL in the console (useful for debugging, desactivar en producción)
spring.jpa.show-sql=true

# Format SQL output for better readability
spring.jpa.properties.hibernate.format_sql=true

# Use SQL comments to identify the origin of queries
spring.jpa.properties.hibernate.use_sql_comments=true

# Logging SQL statements
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=DEBUG
logging.level.org.hibernate.orm.jdbc.bind=DEBUG

# Initialize the database with data from init-db.sql
# DISABLED: Using DataInitializer.java instead for better timing control
spring.sql.init.mode=never
# spring.sql.init.data-locations=classpath:init-db.sql
spring.jpa.defer-datasource-initialization=false


# Naming strategy - usar snake_case para columnas y tablas
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.jpa.hibernate.naming.implicit-strategy=org.hibernate.boot.model.naming.ImplicitNamingStrategyJpaCompliantImpl

# Enable batch processing for better performance
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.batch_versioned_data=true

# Enable second-level cache (opcional, requiere configuración adicional)
# spring.jpa.properties.hibernate.cache.use_second_level_cache=true
# spring.jpa.properties.hibernate.cache.region.factory_class=org.hibernate.cache.jcache.JCacheRegionFactory

# Enable query cache (opcional)
# spring.jpa.properties.hibernate.cache.use_query_cache=true

# Enable statistics for monitoring (desactivar en producción si no se usa)
spring.jpa.properties.hibernate.generate_statistics=false

# Configuración de HikariCP (Pool de conexiones)
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=20000
spring.datasource.hikari.idle-timeout=300000
spring.datasource.hikari.max-lifetime=1200000
spring.datasource.hikari.auto-commit=true
spring.datasource.hikari.pool-name=EPaCe-HikariCP

# Enable JPA auditing (para @CreatedDate, @LastModifiedDate, etc.)
spring.jpa.properties.hibernate.enable_lazy_load_no_trans=false

# Timezone configuration
spring.jpa.properties.hibernate.jdbc.time_zone=UTC



# Disable Docker Compose support since we have manual DB configuration
spring.docker.compose.enabled=false

#--------------------------------------------------------------------
#               Mail Configuration (Recuperación de Contraseña)
#--------------------------------------------------------------------
# Nota: Configurado para Gmail, requiere habilitar "Contraseñas de aplicaciones"
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME:mail.epace@gmail.com}
spring.mail.password=${MAIL_PASSWORD:scrzjsvpnkvdeima}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.smtp.starttls.required=true
spring.mail.properties.mail.smtp.connectiontimeout=5000
spring.mail.properties.mail.smtp.timeout=5000
spring.mail.properties.mail.smtp.writetimeout=5000